<tr id="event-row-{{ e.id }}">
  <td class="px-3 py-2 text-slate-300">
    {% if e.ai_suggested_order %}
      <span class="rounded bg-indigo-500/20 px-2 py-1 text-xs text-indigo-200">{{ e.ai_suggested_order }}</span>
    {% else %}
      <span class="text-slate-400">{{ e.approx_order }}</span>
    {% endif %}
  </td>
  <td class="px-3 py-2 text-slate-300">
    {% if e.act or e.beat %}
      <div class="text-xs text-slate-200">{{ e.act or "—" }}</div>
      <div class="text-xs text-slate-400">{{ e.beat or "—" }}</div>
    {% else %}
      <span class="text-slate-500">—</span>
    {% endif %}
  </td>
  <td class="px-3 py-2 font-medium">{{ linkify_mentions(e.title) }}</td>
  <td class="px-3 py-2 text-slate-300">{{ e.status }}</td>
  <td class="px-3 py-2 text-slate-300">{{ e.importance }}</td>
  <td class="px-3 py-2 text-slate-300">
    {% if tags|length == 0 %}
      <span class="text-slate-500">—</span>
    {% else %}
      {{ tags|join(", ") }}
    {% endif %}
  </td>
  <td class="px-3 py-2 text-slate-300">
    {% if e.description %}
      <details class="mb-2 rounded border border-slate-800 bg-slate-950/40 p-2">
        <summary class="cursor-pointer text-xs text-slate-300">description</summary>
        <div class="mt-2 whitespace-pre-wrap text-xs text-slate-200">{{ linkify_mentions(e.description) }}</div>
      </details>
    {% endif %}
    {% if e.ai_notes %}
      <div class="max-w-md whitespace-pre-wrap text-slate-200">{{ linkify_mentions(e.ai_notes) }}</div>
    {% else %}
      <span class="text-slate-500">—</span>
    {% endif %}
  </td>
  <td class="px-3 py-2">
    {% if e.is_incomplete %}
      <span class="rounded bg-amber-500/20 px-2 py-1 text-xs text-amber-200">incomplete</span>
    {% else %}
      <span class="text-slate-500 text-xs">—</span>
    {% endif %}
  </td>
  <td class="px-3 py-2 text-right whitespace-nowrap">
    <button
      class="rounded border border-slate-700 px-2 py-1 text-xs text-slate-200 hover:bg-slate-900"
      hx-get="/timeline/events/{{ e.id }}/edit"
      hx-target="#event-row-{{ e.id }}"
      hx-swap="outerHTML"
    >
      edit
    </button>
    <button
      class="ml-2 rounded border border-slate-700 px-2 py-1 text-xs text-slate-200 hover:bg-slate-900"
      hx-post="/timeline/events/{{ e.id }}/toggle_incomplete"
      hx-target="#event-table"
      hx-swap="innerHTML"
    >
      toggle incomplete
    </button>
    <button
      class="ml-2 rounded border border-slate-700 px-2 py-1 text-xs text-slate-200 hover:bg-slate-900"
      hx-post="/timeline/events/{{ e.id }}/delete"
      hx-target="#event-table"
      hx-swap="innerHTML"
      hx-confirm="Delete {{ e.title }}?"
    >
      delete
    </button>
  </td>
</tr>


